#!/bin/sh

. script/script_setup
echo $DIR

# Run the python test suite

# Build the core image so the requirements are up to date
docker-compose build;

# Mount the entire repo and run only the unit tests
AWS_ACCESS_KEY_ID=$(aws --profile dev configure get aws_access_key_id) \
AWS_SECRET_ACCESS_KEY=$(aws --profile dev configure get aws_secret_access_key) \
docker-compose run --rm console \
  bash -c "coverage run --source core /usr/local/bin/pytest tests/unit && coverage report $1"
